<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Swachify Admin Dashboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Inter', sans-serif; overflow: hidden; }
    
    .fade-in { animation: fadeIn 0.3s ease-in; }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .notification-dot {
      animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: .5; }
    }

    .sidebar-active {
      background: linear-gradient(135deg, #0d9488 0%, #14b8a6 100%);
      color: white;
    }

    .modal {
      backdrop-filter: blur(4px);
    }
     /* Style for the back button */
     .back-button {
        display: inline-flex;
        align-items: center;
        padding: 8px 16px;
        border-radius: 8px;
        background-color: #f1f5f9;
        color: #475569;
        font-weight: 500;
        transition: background-color: 0.3s;
    }
    .back-button:hover {
        background-color: #e2e8f0;
    }
    /* Ensure all views are hidden by default, JS will manage visibility */
    .view {
        display: none;
    }
    /* Class to show the active view */
    .view.active {
        display: block;
    }
    /* Custom styling for acknowledgement checkmark */
    .checkmark-circle {
        width: 80px;
        height: 80px;
        border-radius: 50%;
        display: flex;
        justify-content: center;
        align-items: center;
        background-color: #dcfce7; /* green-100 */
    }
    .checkmark {
        width: 40px;
        height: 40px;
        color: #22c55e; /* green-500 */
    }
    /* Custom Scrollbar */
    .custom-scrollbar::-webkit-scrollbar {
        width: 6px;
    }
    .custom-scrollbar::-webkit-scrollbar-track {
        background: transparent;
    }
    .custom-scrollbar::-webkit-scrollbar-thumb {
        background: #cbd5e1;
        border-radius: 6px;
    }
    .custom-scrollbar::-webkit-scrollbar-thumb:hover {
        background: #94a3b8;
    }
    .service-card-hover:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 20px rgba(0,0,0,0.05);
        border-color: #14b8a6;
    }
  </style>
</head>
<body class="bg-slate-50">

  <!-- Loading Splash -->
  <div id="splash" class="fixed inset-0 flex items-center justify-center bg-white z-50 transition-opacity duration-500">
    <img src="./SWACHIFY gif.gif" alt="Loading" class="w-32 h-32 rounded-full shadow-2xl" />
  </div>

  <!-- Top Navigation -->
  <header class="fixed top-0 left-0 right-0 bg-white border-b border-slate-200 z-40">
  <div class="flex items-center justify-between px-4 lg:px-6 py-3">
    <!-- Left: Logo + Menu -->
    <div class="flex items-center gap-3">
      <button id="menuToggle" class="lg:hidden p-2 rounded-lg hover:bg-slate-100">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
        </svg>
      </button>
      <img src="./SWACHIFY gif.gif" alt="Swachify" class="w-10 h-10 rounded-full" />
      <h1 class="text-xl font-bold bg-gradient-to-r from-teal-600 to-cyan-600 bg-clip-text text-transparent">Swachify</h1>
    </div>

    <!-- Middle: Search Bar -->
    <div class="hidden md:flex items-center bg-slate-100 rounded-xl px-3 py-2 w-80 focus-within:ring-2 focus-within:ring-teal-400 transition ms-auto">
        <svg class="w-5 h-5 text-slate-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
          d="M21 21l-4.35-4.35M10 18a8 8 0 110-16 8 8 0 010 16z" />
      </svg>
      <input 
        type="text" 
        id="searchInput" 
        placeholder="Search services, customers..." 
        class="bg-transparent outline-none w-full text-sm text-slate-700 placeholder-slate-500"
        oninput="handleSearch(event)"
      />
    </div>
    <div class="relative w-48 ms-auto ">
    <select
      id="locationFilter"
      onchange="renderEmployees()"
      class="pl-10 pr-4 py-1.5 border-2 border-slate-200 rounded-lg text-sm text-slate-700 appearance-none focus:outline-none focus:ring-2 focus:ring-teal-500 transition-all w-full"
    >
      <option value="all">All Locations</option>
      <option value="Delhi">Delhi</option>
      <option value="Mumbai">Mumbai</option>
      <option value="Bangalore">Bangalore</option>
      <option value="Hyderabad">Hyderabad</option>
    </select>
    <div class="absolute left-3 top-1/2 transform -translate-y-1/2 pointer-events-none">
      <!-- Red Google Maps Pin SVG -->
      <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-red-600" fill="currentColor" viewBox="0 0 24 24" stroke="none">
        <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5a2.5 2.5 0 1 1 0-5 2.5 2.5 0 0 1 0 5z"/>
      </svg>
    </div>
  </div>


    <!-- Right: Notifications + Profile -->
    <div class="flex items-center gap-3">
      <!-- Search Icon (Mobile) -->
      <button onclick="toggleMobileSearch()" class="md:hidden p-2 rounded-lg hover:bg-slate-100">
        <svg class="w-6 h-6 text-slate-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
            d="M21 21l-4.35-4.35M10 18a8 8 0 110-16 8 8 0 010 16z"/>
        </svg>
      </button>

      <!-- Notifications -->
      <button onclick="toggleNotifications()" class="relative p-2 rounded-full hover:bg-slate-100 transition">
        <svg class="w-6 h-6 text-slate-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
            d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"/>
        </svg>
        <span id="notifBadge" class="absolute top-0 right-0 w-5 h-5 bg-red-500 text-white text-xs rounded-full flex items-center justify-center notification-dot">3</span>
      </button>

      <!-- Profile -->
      <div class="flex items-center gap-2">
        <div class="hidden sm:block text-right">
          <div class="text-sm font-semibold" id="adminName">Admin User</div>
          <div class="text-xs text-slate-500">Administrator</div>
        </div>
        <button onclick="showSection('profile')" class="w-10 h-10 rounded-full bg-gradient-to-br from-teal-500 to-cyan-500 flex items-center justify-center text-white font-bold">
          A
        </button>
      </div>
    </div>
  </div>

  <!-- Mobile Search (Hidden by Default) -->
  <div id="mobileSearch" class="hidden px-4 pb-3 md:hidden">
    <div class="flex items-center bg-slate-100 rounded-xl px-3 py-2 w-full focus-within:ring-2 focus-within:ring-teal-400 transition">
      <svg class="w-5 h-5 text-slate-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
          d="M21 21l-4.35-4.35M10 18a8 8 0 110-16 8 8 0 010 16z" />
      </svg>
      <input 
        type="text" 
        placeholder="Search..." 
        class="bg-transparent outline-none w-full text-sm text-slate-700 placeholder-slate-500"
        oninput="handleSearch(event)"
      />
    </div>
  </div>
</header>

<!-- Global Search Results -->
<div id="globalSearchResults" class="hidden fixed top-16 left-0 right-0 bottom-0 bg-black/40 backdrop-blur-sm z-40 p-4 lg:left-64">
    <div class="bg-white rounded-2xl w-full max-w-4xl mx-auto max-h-full overflow-y-auto p-6 shadow-2xl">
        <div class="flex items-center justify-between mb-4">
            <h2 class="text-xl font-bold text-slate-800">Search Results for "<span id="searchQueryDisplay"></span>"</h2>
            <button onclick="closeGlobalSearch()" class="text-slate-500 hover:text-slate-800 text-2xl font-bold">&times;</button>
        </div>
        <div id="searchResultsContainer" class="space-y-6">
            <!-- Results will be injected here -->
            <p class="text-slate-500 text-center py-8">Start typing to see results...</p>
        </div>
    </div>
</div>


  <!-- Notification Dropdown -->
  <div id="notificationPanel" class="hidden fixed top-16 right-4 w-80 bg-white rounded-xl shadow-2xl border border-slate-200 z-50 max-h-96 overflow-y-auto">
    <div class="p-4 border-b border-slate-200">
      <div class="flex items-center justify-between">
        <h3 class="font-bold text-slate-800">Notifications</h3>
        <button onclick="clearAllNotifications()" class="text-xs text-teal-600 hover:text-teal-700">Clear All</button>
      </div>
    </div>
    <div id="notificationList" class="divide-y divide-slate-100">
      <!-- Notifications will be inserted here -->
    </div>
  </div>

  <div class="flex pt-16 h-screen">
    <!-- Sidebar -->
    <aside id="sidebar" class="fixed lg:sticky top-16 left-0 h-[calc(100vh-4rem)] w-64 bg-white border-r border-slate-200 transform -translate-x-full lg:translate-x-0 transition-transform duration-300 z-30">
      <nav class="p-4 space-y-2">
        <button onclick="showSection('dashboard')" class="sidebar-btn sidebar-active w-full flex items-center gap-3 px-4 py-3 rounded-lg transition-all" data-section="dashboard">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/>
          </svg>
          <span class="font-semibold">Dashboard</span>
        </button>

        <button onclick="showSection('services')" class="sidebar-btn w-full flex items-center gap-3 px-4 py-3 rounded-lg text-slate-600 hover:bg-slate-100 transition-all" data-section="services">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"/>
          </svg>
          <span class="font-semibold">Request Service</span>
        </button>

        <button onclick="showSection('bookings')" class="sidebar-btn w-full flex items-center gap-3 px-4 py-3 rounded-lg text-slate-600 hover:bg-slate-100 transition-all" data-section="bookings">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
          </svg>
          <span class="font-semibold">Bookings</span>
          <span id="bookingBadge" class="ml-auto bg-teal-100 text-teal-600 text-xs px-2 py-1 rounded-full">0</span>
        </button>

        <button onclick="showSection('tickets')" class="sidebar-btn w-full flex items-center gap-3 px-4 py-3 rounded-lg text-slate-600 hover:bg-slate-100 transition-all" data-section="tickets">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"/>
          </svg>
          <span class="font-semibold">Tickets</span>
          <span id="ticketBadge" class="ml-auto bg-amber-100 text-amber-600 text-xs px-2 py-1 rounded-full">0</span>
        </button>

        <button onclick="showSection('employees')" class="sidebar-btn w-full flex items-center gap-3 px-4 py-3 rounded-lg text-slate-600 hover:bg-slate-100 transition-all" data-section="employees">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"/>
          </svg>
          <span class="font-semibold">Employees</span>
        </button>

        <button onclick="showSection('profile')" class="sidebar-btn w-full flex items-center gap-3 px-4 py-3 rounded-lg text-slate-600 hover:bg-slate-100 transition-all" data-section="profile">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
          </svg>
          <span class="font-semibold">Profile</span>
        </button>

        <button onclick="showSection('settings')" class="sidebar-btn w-full flex items-center gap-3 px-4 py-3 rounded-lg text-slate-600 hover:bg-slate-100 transition-all" data-section="settings">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"/>
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
          </svg>
          <span class="font-semibold">Settings</span>
        </button>

        <div class="pt-4 border-t border-slate-200 mt-4">
          <button onclick="logout()" class="w-full flex items-center gap-3 px-4 py-3 rounded-lg text-red-600 hover:bg-red-50 transition-all">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"/>
            </svg>
            <span class="font-semibold">Logout</span>
          </button>
        </div>
      </nav>
    </aside>

    <!-- Sidebar Overlay for Mobile -->
    <div id="sidebarOverlay" class="hidden fixed inset-0 bg-black/50 z-20 lg:hidden" onclick="toggleSidebar()"></div>

    <!-- Main Content -->
    <main class="flex-1 p-4 lg:p-8 overflow-hidden h-[calc(100vh-4rem)]">
      
      <!-- Dashboard Section -->
      <section id="dashboard" class="content-section fade-in flex flex-col h-full">
        <div class="flex-shrink-0"> <!-- Header container -->
            <h2 class="text-3xl font-bold mb-2">Welcome Back! ðŸ‘‹</h2>
        </div>
        
        <!-- Stats Grid -->
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8 flex-shrink-0">
          <div class="bg-gradient-to-br from-teal-500 to-cyan-500 text-white rounded-2xl p-6">
            <div class="flex items-center justify-between mb-2">
              <span class="text-teal-100">Total Services</span>
              <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
              </svg>
            </div>
            <div class="text-3xl font-bold" id="totalServices">0</div>
            <div class="text-xs text-teal-100 mt-1">All time</div>
          </div>

          <div class="bg-white rounded-2xl p-6 border-2 border-blue-200">
            <div class="flex items-center justify-between mb-2">
              <span class="text-slate-600">Active Bookings</span>
              <svg class="w-8 h-8 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
              </svg>
            </div>
            <div class="text-3xl font-bold text-blue-600" id="activeBookings">0</div>
            <div class="text-xs text-slate-500 mt-1">Pending assignment</div>
          </div>

          <div class="bg-white rounded-2xl p-6 border-2 border-emerald-200">
            <div class="flex items-center justify-between mb-2">
              <span class="text-slate-600">Open Tickets</span>
              <svg class="w-8 h-8 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"/>
              </svg>
            </div>
            <div class="text-3xl font-bold text-emerald-600" id="openTickets">0</div>
            <div class="text-xs text-slate-500 mt-1">In progress</div>
          </div>

          <div class="bg-white rounded-2xl p-6 border-2 border-purple-200">
            <div class="flex items-center justify-between mb-2">
              <span class="text-slate-600">Employees</span>
              <svg class="w-8 h-8 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"/>
              </svg>
            </div>
            <div class="text-3xl font-bold text-purple-600" id="totalEmployees">8</div>
            <div class="text-xs text-slate-500 mt-1">Available staff</div>
          </div>
        </div>

        <!-- Recent Activity -->
        <div class="grid lg:grid-cols-2 gap-6 flex-grow min-h-0">

  <!-- Recent Bookings -->
  <div class="bg-white rounded-2xl p-6 border border-slate-200 flex flex-col" style="min-height:0;">
    <h3 class="text-xl font-bold mb-4 flex-shrink-0">Recent Bookings</h3>

    <!-- Scrollable list area -->
    <div id="recentBookingsList"
         class="space-y-3 overflow-y-auto custom-scrollbar flex-grow"
         style="
           max-height: 420px;
           overflow-y: auto;
           padding-right: 6px;
           scroll-behavior: smooth;

           /* Firefox scrollbar */
           scrollbar-width: thin;
           scrollbar-color: #cbd5e1 transparent;
         ">
      <div class="text-center py-8 text-slate-400">
        <svg class="w-12 h-12 mx-auto mb-2 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"/>
        </svg>
        <p>No recent bookings</p>
      </div>
    </div>
  </div>

  <!-- Active Tickets -->
  <div class="bg-white rounded-2xl p-6 border border-slate-200 flex flex-col" style="min-height:0;">
    <h3 class="text-xl font-bold mb-4 flex-shrink-0">Active Tickets</h3>

    <!-- Scrollable list area -->
    <div id="activeTicketsList"
         class="space-y-3 overflow-y-auto custom-scrollbar flex-grow"
         style="
           max-height: 420px;
           overflow-y: auto;
           padding-right: 6px;
           scroll-behavior: smooth;

           /* Firefox scrollbar */
           scrollbar-width: thin;
           scrollbar-color: #cbd5e1 transparent;
         ">
      <div class="text-center py-8 text-slate-400">
        <svg class="w-12 h-12 mx-auto mb-2 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"/>
        </svg>
        <p>No active tickets</p>
      </div>
    </div>
  </div>
</div>

<!-- Inline style block only for WebKit scrollbar pseudo-elements and responsive heights -->
<style>
  /* WebKit scrollbar styling (cannot be in style="" attributes) */
  #recentBookingsList::-webkit-scrollbar,
  #activeTicketsList::-webkit-scrollbar { width: 10px; }
  #recentBookingsList::-webkit-scrollbar-track,
  #activeTicketsList::-webkit-scrollbar-track { background: transparent; }
  #recentBookingsList::-webkit-scrollbar-thumb,
  #activeTicketsList::-webkit-scrollbar-thumb {
    background: #d1d5db; border-radius: 999px; border: 2px solid #fff;
  }
  #recentBookingsList:hover::-webkit-scrollbar-thumb,
  #activeTicketsList:hover::-webkit-scrollbar-thumb { background: #94a3b8; }

  /* Responsive max-heights */
  @media (max-width:1100px){
    #recentBookingsList, #activeTicketsList { max-height: 360px; }
  }
  @media (max-width:640px){
    #recentBookingsList, #activeTicketsList { max-height: 280px; }
  }
</style>

    
        <!-- âœ… Fixed Help Button -->
<div id="chatButton" 
   class="fixed bottom-6 right-6 bg-green-500 hover:bg-green-600 text-white px-5 py-3 rounded-full shadow-lg flex items-center gap-2 font-semibold transition-all cursor-pointer z-50">
  <img src="https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg" alt="WhatsApp" class="w-5 h-5" />
  Help
</div>



<!-- âœ… Popup Form -->
<div id="chatPopup" 
     class="hidden fixed bottom-24 right-6 bg-white shadow-2xl rounded-2xl w-80 p-5 border border-slate-200 transition-all z-50">
  <div class="flex justify-between items-center mb-3">
    <h2 class="text-lg font-semibold text-slate-800">WhatsApp Us</h2>
    <button id="closePopup" class="text-slate-500 hover:text-red-500 text-xl">&times;</button>
  </div>


  <form id="whatsappForm" class="space-y-3">
    <div>
      <label class="block text-sm text-slate-600 mb-1">Name</label>
      <input type="text" class="w-full border border-slate-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-400" placeholder="Enter your name" required>
    </div>


    <div>
      <label class="block text-sm text-slate-600 mb-1">Your WhatsApp Number</label>
      <input type="tel" class="w-full border border-slate-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-400" placeholder="+91 9876543210" required>
    </div>


    <div>
      <label class="block text-sm text-slate-600 mb-1">Query</label>
      <textarea class="w-full border border-slate-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-400" rows="3" placeholder="Type your message..." required></textarea>
    </div>


    <button type="submit" class="w-full bg-green-500 hover:bg-green-600 text-white py-2 rounded-lg font-semibold transition-all">
      Send on WhatsApp
    </button>
  </form>
</div>


<!-- âœ… Popup Logic -->
<script>
  const chatButton = document.getElementById('chatButton');
  const chatPopup = document.getElementById('chatPopup');
  const closePopup = document.getElementById('closePopup');
  const form = document.getElementById('whatsappForm');


  // Toggle popup
  chatButton.addEventListener('click', () => {
    chatPopup.classList.toggle('hidden');
  });


  closePopup.addEventListener('click', () => {
    chatPopup.classList.add('hidden');
  });


  // Handle form submission
  form.addEventListener('submit', (e) => {
    e.preventDefault();
    const name = form.querySelector('input[type="text"]').value;
    const number = form.querySelector('input[type="tel"]').value.replace(/\D/g, '');
    const query = form.querySelector('textarea').value;


    const message = `Hello, my name is ${name}. ${query}`;
    const whatsappURL = `https://wa.me/${number}?text=${encodeURIComponent(message)}`;
    window.open(whatsappURL, '_blank');
  });
</script>
    
      </section>

      <!-- Services Section -->
      <section id="services" class="content-section hidden h-full overflow-y-auto custom-scrollbar">
        <main class="bg-white p-8 rounded-xl shadow-sm w-full">
        
        <div id="main-view" class="view active">
            <header class="mb-8">
                <h1 class="text-3xl font-bold text-slate-800">What are you looking for?</h1>
            </header>
            <div id="services-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
                <div class="group bg-slate-50 border-2 border-slate-200 rounded-xl overflow-hidden transition-all duration-300 cursor-pointer service-card-hover" onclick="navigateTo('sub-services-cleaning', 'Cleaning & Pest Control')">
                    <img src="cleaning.jpg" alt="Cleaning Service" class="h-40 w-full object-cover">
                    <div class="p-4"><h3 class="font-semibold text-slate-700">Cleaning & Pest Control</h3></div>
                </div>
                <div class="group bg-slate-50 border-2 border-slate-200 rounded-xl overflow-hidden transition-all duration-300 cursor-pointer service-card-hover" onclick="navigateTo('sub-services-electrician', 'Electrician, Plumber & Carpenter')">
                    <img src="electrician.jpeg" alt="Plumber Service" class="h-40 w-full object-cover">
                    <div class="p-4"><h3 class="font-semibold text-slate-700">Electrician, Plumber & Carpenter</h3></div>
                </div>
                <div class="group bg-slate-50 border-2 border-slate-200 rounded-xl overflow-hidden transition-all duration-300 cursor-pointer service-card-hover" onclick="navigateTo('sub-services-painting', 'Painting & Waterproofing')">
                    <img src="painting.png" alt="Painting Service" class="h-40 w-full object-cover">
                    <div class="p-4"><h3 class="font-semibold text-slate-700">Painting & Waterproofing</h3></div>
                </div>
                <div class="group bg-slate-50 border-2 border-slate-200 rounded-xl overflow-hidden transition-all duration-300 cursor-pointer service-card-hover" onclick="navigateTo('sub-services-ac', 'AC & Appliances')">
                    <img src="ac-repair.jpg" alt="AC Repair Service" class="h-40 w-full object-cover">
                    <div class="p-4"><h3 class="font-semibold text-slate-700">AC & Appliances</h3></div>
                </div>
            </div>
        </div>

        <div id="sub-services-cleaning-view" class="view">
            <header class="mb-8">
                <button class="back-button mb-4" onclick="goBack()"><svg class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" /></svg> Back</button>
                <h1 class="text-3xl font-bold text-slate-800" data-service-category="Cleaning & Pest Control">Cleaning & Pest Control</h1>
                <p class="text-slate-500 mt-2">Please choose a sub-category.</p>
            </header>
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
                <div class="group cursor-pointer service-card-hover border-2 rounded-xl" onclick="navigateTo('pricing-bedroom', 'Bedroom Cleaning')"><img src="images1/cleaning&pest control/bedroom-cleaning.jpg" alt="Bedroom Cleaning" class="h-28 w-full object-cover rounded-t-xl"><div class="p-3 text-center"><h3 class="font-semibold text-slate-700 text-sm">Bedroom</h3></div></div>
                <div class="group cursor-pointer service-card-hover border-2 rounded-xl" onclick="navigateTo('pricing-generic', 'Bathroom Cleaning')"><img src="images1/cleaning&pest control/bathroom cleaning.jpeg" alt="Bathroom Cleaning" class="h-28 w-full object-cover rounded-t-xl"><div class="p-3 text-center"><h3 class="font-semibold text-slate-700 text-sm">Bathroom</h3></div></div>
                <div class="group cursor-pointer service-card-hover border-2 rounded-xl" onclick="navigateTo('pricing-generic', 'Kitchen Cleaning')"><img src="images1/cleaning&pest control/kitchen cleaning.jpg" alt="Kitchen Cleaning" class="h-28 w-full object-cover rounded-t-xl"><div class="p-3 text-center"><h3 class="font-semibold text-slate-700 text-sm">Kitchen</h3></div></div>
                <div class="group cursor-pointer service-card-hover border-2 rounded-xl" onclick="navigateTo('pricing-generic', 'Living Area Cleaning')"><img src="images1/cleaning&pest control/living area cleaning.jpg" alt="Living Area" class="h-28 w-full object-cover rounded-t-xl"><div class="p-3 text-center"><h3 class="font-semibold text-slate-700 text-sm">Living Area</h3></div></div>
                <div class="group cursor-pointer service-card-hover border-2 rounded-xl" onclick="navigateTo('pricing-generic', 'Sofa & Carpet Cleaning')"><img src="images1/cleaning&pest control/sofa cleaning.jpg" alt="Sofa & Carpet" class="h-28 w-full object-cover rounded-t-xl"><div class="p-3 text-center"><h3 class="font-semibold text-slate-700 text-sm">Sofa & Carpet</h3></div></div>
                <div class="group cursor-pointer service-card-hover border-2 rounded-xl" onclick="navigateTo('pricing-generic', 'Pest Control')"><img src="images1/cleaning&pest control/pest control.jpg" alt="Pest Control" class="h-28 w-full object-cover rounded-t-xl"><div class="p-3 text-center"><h3 class="font-semibold text-slate-700 text-sm">Pest Control</h3></div></div>
            </div>
        </div>
        
        <div id="sub-services-electrician-view" class="view">
            <header class="mb-8">
            <button class="back-button mb-4" onclick="goBack()"><svg class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" /></svg> Back</button>
            <h1 class="text-3xl font-bold text-slate-800" data-service-category="Electrician, Plumber & Carpenter">Electrician, Plumber & Carpenter</h1>
            <p class="text-slate-500 mt-2">Please choose a sub-category.</p>
        </header>
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
            <div class="group cursor-pointer service-card-hover border-2 rounded-xl" onclick="navigateTo('pricing-generic', 'Switch & Sockets')"><img src="images1/electrician/socket.jpg" alt="Switch & Sockets" class="h-28 w-full object-cover rounded-t-xl"><div class="p-3 text-center"><h3 class="font-semibold text-slate-700 text-sm">Switch & Sockets</h3></div></div>
            <div class="group cursor-pointer service-card-hover border-2 rounded-xl" onclick="navigateTo('pricing-generic', 'Fan Repair')"><img src="images1/electrician/fan.jpg" alt="Fan" class="h-28 w-full object-cover rounded-t-xl"><div class="p-3 text-center"><h3 class="font-semibold text-slate-700 text-sm">Fan</h3></div></div>
            <div class="group cursor-pointer service-card-hover border-2 rounded-xl" onclick="navigateTo('pricing-generic', 'Wiring')"><img src="images1/electrician/wiring.jpg" alt="Wiring" class="h-28 w-full object-cover rounded-t-xl"><div class="p-3 text-center"><h3 class="font-semibold text-slate-700 text-sm">Wiring</h3></div></div>
            <div class="group cursor-pointer service-card-hover border-2 rounded-xl" onclick="navigateTo('pricing-generic', 'Bath Fitting')"><img src="images1/electrician/bath.jpg" alt="Bath Fitting" class="h-28 w-full object-cover rounded-t-xl"><div class="p-3 text-center"><h3 class="font-semibold text-slate-700 text-sm">Bath Fitting</h3></div></div>
            <div class="group cursor-pointer service-card-hover border-2 rounded-xl" onclick="navigateTo('pricing-generic', 'Sink & Basin Repair')"><img src="images1/electrician/sink.jpg" alt="Sink & Basin" class="h-28 w-full object-cover rounded-t-xl"><div class="p-3 text-center"><h3 class="font-semibold text-slate-700 text-sm">Sink & Basin</h3></div></div>
            <div class="group cursor-pointer service-card-hover border-2 rounded-xl" onclick="navigateTo('pricing-generic', 'Carpenter')"><img src="images1/electrician/carpenter.jpg" alt="Carpenter" class="h-28 w-full object-cover rounded-t-xl"><div class="p-3 text-center"><h3 class="font-semibold text-slate-700 text-sm">Carpenter</h3></div></div>
        </div>
        </div>

        <div id="sub-services-painting-view" class="view">
                <header class="mb-8">
                <button class="back-button mb-4" onclick="goBack()"><svg class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" /></svg> Back</button>
                <h1 class="text-3xl font-bold text-slate-800" data-service-category="Painting & Waterproofing">Painting & Waterproofing</h1>
                <p class="text-slate-500 mt-2">Please choose a sub-category.</p>
            </header>
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
                <div class="group cursor-pointer service-card-hover border-2 rounded-xl" onclick="navigateTo('pricing-generic', 'Full House Painting')"><img src="images1/painting/house.jpeg" alt="Full House Painting" class="h-28 w-full object-cover rounded-t-xl"><div class="p-3 text-center"><h3 class="font-semibold text-slate-700 text-sm">Full House Painting</h3></div></div>
                <div class="group cursor-pointer service-card-hover border-2 rounded-xl" onclick="navigateTo('pricing-generic', 'Room Painting')"><img src="images1/painting/room.png" alt="Room Painting" class="h-28 w-full object-cover rounded-t-xl"><div class="p-3 text-center"><h3 class="font-semibold text-slate-700 text-sm">Room Painting</h3></div></div>
                <div class="group cursor-pointer service-card-hover border-2 rounded-xl" onclick="navigateTo('pricing-generic', 'Exterior Painting')"><img src="images1/painting/exterior.png" alt="Exterior" class="h-28 w-full object-cover rounded-t-xl"><div class="p-3 text-center"><h3 class="font-semibold text-slate-700 text-sm">Exterior Painting</h3></div></div>
                <div class="group cursor-pointer service-card-hover border-2 rounded-xl" onclick="navigateTo('pricing-generic', 'Waterproofing')"><img src="images1/painting/waterproof.webp" alt="Waterproofing" class="h-28 w-full object-cover rounded-t-xl"><div class="p-3 text-center"><h3 class="font-semibold text-slate-700 text-sm">Waterproofing</h3></div></div>
                </div>
        </div>

        <div id="sub-services-ac-view" class="view">
                <header class="mb-8">
                <button class="back-button mb-4" onclick="goBack()"><svg class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" /></svg> Back</button>
                <h1 class="text-3xl font-bold text-slate-800" data-service-category="AC & Appliances">AC & Appliances</h1>
                <p class="text-slate-500 mt-2">Please choose a sub-category.</p>
            </header>
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
                    <div class="group cursor-pointer service-card-hover border-2 rounded-xl" onclick="navigateTo('pricing-generic', 'AC Service & Repair')"><img src="images1/AC/ac repair.jpg" alt="AC Repair" class="h-28 w-full object-cover rounded-t-xl"><div class="p-3 text-center"><h3 class="font-semibold text-slate-700 text-sm">AC Service & Repair</h3></div></div>
                    <div class="group cursor-pointer service-card-hover border-2 rounded-xl" onclick="navigateTo('pricing-generic', 'Refrigerator Repair')"><img src="images1/AC/fridge.jpg" alt="Refrigerator" class="h-28 w-full object-cover rounded-t-xl"><div class="p-3 text-center"><h3 class="font-semibold text-slate-700 text-sm">Refrigerator Repair</h3></div></div>
                    <div class="group cursor-pointer service-card-hover border-2 rounded-xl" onclick="navigateTo('pricing-generic', 'Washing Machine Repair')"><img src="images1/AC/washin.jpeg" alt="Washing Machine" class="h-28 w-full object-cover rounded-t-xl"><div class="p-3 text-center"><h3 class="font-semibold text-slate-700 text-sm">Washing Machine Repair</h3></div></div>
                    <div class="group cursor-pointer service-card-hover border-2 rounded-xl" onclick="navigateTo('pricing-generic', 'Microwave Repair')"><img src="images1/AC/oven.jpg" alt="Microwave" class="h-28 w-full object-cover rounded-t-xl"><div class="p-3 text-center"><h3 class="font-semibold text-slate-700 text-sm">Microwave Repair</h3></div></div>
            </div>
        </div>

        <div id="pricing-bedroom-view" class="view" data-sub-service="Bedroom Cleaning">
                <header class="mb-8">
                <button class="back-button mb-4" onclick="goBack()"><svg class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" /></svg> Back</button>
                <h1 class="text-3xl font-bold text-slate-800">Bedroom Cleaning Services</h1>
                <p class="text-slate-500 mt-2">Select a plan to continue.</p>
            </header>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="border border-slate-200 rounded-xl p-6 flex flex-col service-card-hover">
                    <h3 class="text-xl font-bold text-slate-800">Regular</h3>
                    <p class="text-3xl font-bold my-4">$49<span class="text-base font-medium text-slate-500">/room</span></p>
                    <ul class="space-y-2 text-slate-600 mb-6"><li class="flex items-center"><svg class="h-5 w-5 text-green-500 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" /></svg>Mopped & Vacuumed</li><li class="flex items-center"><svg class="h-5 w-5 text-green-500 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" /></svg>Surfaces Dusted</li></ul>
                    <button class="mt-auto w-full bg-teal-600 text-white font-semibold py-2 rounded-lg hover:bg-teal-700 transition-colors" onclick="navigateTo('booking-form', 'Regular')">Book Now</button>
                </div>
                <div class="border-2 border-teal-600 rounded-xl p-6 flex flex-col relative service-card-hover">
                    <div class="absolute top-0 -translate-y-1/2 bg-teal-600 text-white px-3 py-1 text-sm font-semibold rounded-full">Popular</div>
                    <h3 class="text-xl font-bold text-slate-800">Premium</h3>
                    <p class="text-3xl font-bold my-4">$79<span class="text-base font-medium text-slate-500">/room</span></p>
                    <ul class="space-y-2 text-slate-600 mb-6"><li class="flex items-center"><svg class="h-5 w-5 text-green-500 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" /></svg>Everything in Regular</li><li class="flex items-center"><svg class="h-5 w-5 text-green-500 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" /></svg>Mirrors Polished</li></ul>
                    <button class="mt-auto w-full bg-teal-600 text-white font-semibold py-2 rounded-lg hover:bg-teal-700 transition-colors" onclick="navigateTo('booking-form', 'Premium')">Book Now</button>
                </div>
                <div class="border border-slate-200 rounded-xl p-6 flex flex-col service-card-hover">
                    <h3 class="text-xl font-bold text-slate-800">Ultimate</h3>
                    <p class="text-3xl font-bold my-4">$109<span class="text-base font-medium text-slate-500">/room</span></p>
                        <ul class="space-y-2 text-slate-600 mb-6"><li class="flex items-center"><svg class="h-5 w-5 text-green-500 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" /></svg>Everything in Premium</li><li class="flex items-center"><svg class="h-5 w-5 text-green-500 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" /></svg>Linens Changed</li></ul>
                    <button class="mt-auto w-full bg-teal-600 text-white font-semibold py-2 rounded-lg hover:bg-teal-700 transition-colors" onclick="navigateTo('booking-form', 'Ultimate')">Book Now</button>
                </div>
            </div>
        </div>

        <div id="pricing-generic-view" class="view">
                <header class="mb-8">
                <button class="back-button mb-4" onclick="goBack()"><svg class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" /></svg> Back</button>
                <h1 class="text-3xl font-bold text-slate-800">Our Service Plans</h1>
                <p class="text-slate-500 mt-2">Select a plan to continue.</p>
            </header>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="border border-slate-200 rounded-xl p-6 flex flex-col service-card-hover">
                    <h3 class="text-xl font-bold text-slate-800">Standard</h3>
                    <p class="text-3xl font-bold my-4">$89<span class="text-base font-medium text-slate-500">/visit</span></p>
                    <ul class="space-y-2 text-slate-600 mb-6"><li class="flex items-center"><svg class="h-5 w-5 text-green-500 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" /></svg>Basic Service</li><li class="flex items-center"><svg class="h-5 w-5 text-green-500 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" /></svg>Inspection</li></ul>
                    <button class="mt-auto w-full bg-teal-600 text-white font-semibold py-2 rounded-lg hover:bg-teal-700 transition-colors" onclick="navigateTo('booking-form', 'Standard')">Book Now</button>
                </div>
                <div class="border-2 border-teal-600 rounded-xl p-6 flex flex-col relative service-card-hover">
                    <div class="absolute top-0 -translate-y-1/2 bg-teal-600 text-white px-3 py-1 text-sm font-semibold rounded-full">Popular</div>
                    <h3 class="text-xl font-bold text-slate-800">Advanced</h3>
                    <p class="text-3xl font-bold my-4">$129<span class="text-base font-medium text-slate-500">/visit</span></p>
                    <ul class="space-y-2 text-slate-600 mb-6"><li class="flex items-center"><svg class="h-5 w-5 text-green-500 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" /></svg>Everything in Standard</li><li class="flex items-center"><svg class="h-5 w-5 text-green-500 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" /></svg>Detailed Cleaning</li></ul>
                    <button class="mt-auto w-full bg-teal-600 text-white font-semibold py-2 rounded-lg hover:bg-teal-700 transition-colors" onclick="navigateTo('booking-form', 'Advanced')">Book Now</button>
                </div>
                <div class="border border-slate-200 rounded-xl p-6 flex flex-col service-card-hover">
                    <h3 class="text-xl font-bold text-slate-800">Complete</h3>
                    <p class="text-3xl font-bold my-4">$199<span class="text-base font-medium text-slate-500">/visit</span></p>
                        <ul class="space-y-2 text-slate-600 mb-6"><li class="flex items-center"><svg class="h-5 w-5 text-green-500 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" /></svg>Everything in Advanced</li><li class="flex items-center"><svg class="h-5 w-5 text-green-500 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" /></svg>Parts Replacement</li></ul>
                    <button class="mt-auto w-full bg-teal-600 text-white font-semibold py-2 rounded-lg hover:bg-teal-700 transition-colors" onclick="navigateTo('booking-form', 'Complete')">Book Now</button>
                </div>
            </div>
        </div>

        <div id="booking-form-view" class="view">
            <header class="mb-8">
            <button class="back-button mb-4" onclick="goBack()"><svg class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" /></svg> Back</button>
            <h1 class="text-3xl font-bold text-slate-800">Book Your Service</h1>
            <p class="text-slate-500 mt-2">Confirm your details to schedule the appointment.</p>
            <input type="hidden" id="selected-service-group" value="">
            <input type="hidden" id="selected-sub-service" value="">
            <input type="hidden" id="selected-service-plan" value="">
        </header>
        <div class="grid lg:grid-cols-2 gap-12">
            <form id="booking-form" class="space-y-6">
                <div><label for="name" class="block text-sm font-medium text-slate-700">Full Name</label><input type="text" id="name" required class="mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm placeholder-slate-400 focus:outline-none focus:ring-teal-500 focus:border-teal-500"></div>
                <div><label for="phone" class="block text-sm font-medium text-slate-700">Phone Number</label><input type="tel" id="phone" required class="mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm placeholder-slate-400 focus:outline-none focus:ring-teal-500 focus:border-teal-500"></div>
                <div><label for="address" class="block text-sm font-medium text-slate-700">Address</label><textarea id="address" rows="3" required class="mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm placeholder-slate-400 focus:outline-none focus:ring-teal-500 focus:border-teal-500"></textarea></div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label for="date" class="block text-sm font-medium text-slate-700">Preferred Date</label>
                        <input type="date" id="date" required class="mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-teal-500 focus:border-teal-500">
                    </div>
                    <div>
                        <label for="time-slots" class="block text-sm font-medium text-slate-700">Preferred Time Slot</label>
                        <div id="time-slots" class="grid grid-cols-2 gap-2 mt-1">
                            <button type="button" class="time-slot-btn bg-slate-100 text-slate-700 text-sm py-2 rounded-md transition-colors" data-time="9:00 AM - 11:00 AM">9am - 11am</button>
                            <button type="button" class="time-slot-btn bg-slate-100 text-slate-700 text-sm py-2 rounded-md transition-colors" data-time="11:00 AM - 1:00 PM">11am - 1pm</button>
                            <button type="button" class="time-slot-btn bg-slate-100 text-slate-700 text-sm py-2 rounded-md transition-colors" data-time="1:00 PM - 3:00 PM">1pm - 3pm</button>
                            <button type="button" class="time-slot-btn bg-slate-100 text-slate-700 text-sm py-2 rounded-md transition-colors" data-time="3:00 PM - 5:00 PM">3pm - 5pm</button>
                        </div>
                        <input type="hidden" id="time" required>
                    </div>
                </div>
                <button type="submit" class="w-full bg-teal-600 text-white font-semibold py-3 px-4 rounded-lg hover:bg-teal-700 transition-colors">Place Order</button>
            </form>
            <div class="hidden lg:block bg-gradient-to-br from-teal-50 to-cyan-100 rounded-2xl p-8 flex flex-col justify-center items-center text-center">
                <img src="./SWACHIFY gif.gif" alt="Swachify" class="w-24 h-24 mb-4" />
                <h3 class="text-xl font-bold text-teal-800 mb-2">You're almost there!</h3>
                <p class="text-slate-600">Complete the form to get a sparkling clean space. We guarantee you'll be satisfied with our professional service.</p>
            </div>
        </div>
        </div>
        <div id="acknowledgement-view" class="view text-center">
            <div class="flex justify-center mb-6"><div class="checkmark-circle"><svg class="checkmark" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" /></svg></div></div>
            <h1 class="text-3xl font-bold text-slate-800">Order Placed Successfully!</h1>
            <p class="text-slate-500 mt-4 max-w-md mx-auto">Thank you for your order. Our team will contact you shortly to confirm the details of your appointment.</p>
            <button class="mt-8 bg-teal-600 text-white font-semibold py-2 px-6 rounded-lg hover:bg-teal-700 transition-colors" onclick="navigateTo('main')">Back to Home</button>
        </div>
    </main>
      </section>


      <!-- Bookings Section -->
      <section id="bookings" class="content-section hidden fade-in flex flex-col h-full">
        <div class="flex-shrink-0">
            <h2 class="text-3xl font-bold mb-2">Bookings Management</h2>
        </div>
        <div id="bookingsList" class="space-y-4 flex-grow overflow-y-auto custom-scrollbar pr-2">
          <div class="text-center py-12 text-slate-400">
            <svg class="w-16 h-16 mx-auto mb-3 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
            </svg>
            <p>No pending bookings</p>
          </div>
        </div>
      </section>

      <!-- Tickets Section -->
      <section id="tickets" class="content-section hidden fade-in flex flex-col h-full">
        <div class="flex-shrink-0">
            <h2 class="text-3xl font-bold mb-2">Service Tickets</h2>

            <div class="mb-6 flex gap-3">
            <button onclick="filterTickets('all')" class="ticket-filter-btn px-4 py-2 rounded-lg bg-teal-600 text-white font-medium">All</button>
            <button onclick="filterTickets('open')" class="ticket-filter-btn px-4 py-2 rounded-lg bg-slate-200 text-slate-700 font-medium">Open</button>
            <button onclick="filterTickets('in-progress')" class="ticket-filter-btn px-4 py-2 rounded-lg bg-slate-200 text-slate-700 font-medium">In Progress</button>
            <button onclick="filterTickets('completed')" class="ticket-filter-btn px-4 py-2 rounded-lg bg-slate-200 text-slate-700 font-medium">Completed</button>
            </div>
        </div>
        <div id="ticketsList" class="space-y-4 flex-grow overflow-y-auto custom-scrollbar pr-2">
          <div class="text-center py-12 text-slate-400">
            <svg class="w-16 h-16 mx-auto mb-3 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"/>
            </svg>
            <p>No tickets found</p>
          </div>
        </div>
      </section>

      <!-- Employees Section -->
        <section id="employees" class="content-section hidden fade-in flex flex-col h-full">
            <div class="flex-shrink-0">
                <h2 class="text-3xl font-bold mb-2">Employee Management</h2>
            </div>
            <div class="grid md:grid-cols-3 gap-6 flex-grow min-h-0">
                <div id="employeeListContainer" class="md:col-span-1 bg-white rounded-xl border border-slate-200 p-4 overflow-y-auto custom-scrollbar">
                    <!-- Employee names will be injected here -->
                </div>
                <div id="employeeDetailsContainer" class="md:col-span-2 bg-white rounded-xl border border-slate-200 p-6">
                    <div class="text-center text-slate-500 h-full flex flex-col justify-center">
                        <svg class="w-16 h-16 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm-3 7a4 4 0 110-8 4 4 0 010 8z"/></svg>
                        <p>Select an employee to view their details.</p>
                    </div>
                </div>
            </div>
        </section>


      <!-- Profile Section -->
      <section id="profile" class="content-section hidden fade-in h-full overflow-y-auto custom-scrollbar">
        <h2 class="text-3xl font-bold mb-2">Profile Settings</h2>

        <div class="max-w-2xl">
          <div class="bg-white rounded-2xl p-6 border border-slate-200 mb-6">
            <div class="flex items-center gap-4 mb-6">
              <div class="w-20 h-20 rounded-full bg-gradient-to-br from-teal-500 to-cyan-500 flex items-center justify-center text-white text-3xl font-bold">
                A
              </div>
              <div>
                <h3 class="text-xl font-bold">Admin User</h3>
                <p class="text-slate-600">admin@swachify.com</p>
              </div>
            </div>

            <div class="space-y-4">
              <div>
                <label class="block text-sm font-medium text-slate-700 mb-2">Full Name</label>
                <input type="text" value="Admin User" class="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-teal-500 focus:outline-none">
              </div>
              <div>
                <label class="block text-sm font-medium text-slate-700 mb-2">Email</label>
                <input type="email" value="admin@swachify.com" class="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-teal-500 focus:outline-none">
              </div>
              <div>
                <label class="block text-sm font-medium text-slate-700 mb-2">Phone</label>
                <input type="tel" value="+91 98765 43210" class="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-teal-500 focus:outline-none">
              </div>
              <button class="w-full bg-gradient-to-r from-teal-600 to-cyan-600 text-white py-3 rounded-xl font-semibold hover:shadow-lg transition-all">
                Save Changes
              </button>
            </div>
          </div>
        </div>
      </section>

      <!-- Settings Section -->
      <section id="settings" class="content-section hidden fade-in h-full overflow-y-auto custom-scrollbar">
        <h2 class="text-3xl font-bold mb-2">Settings</h2>

        <div class="max-w-2xl space-y-6">
          <div class="bg-white rounded-2xl p-6 border border-slate-200">
            <h3 class="font-bold text-lg mb-4">Notification Settings</h3>
            <div class="space-y-4">
              <div class="flex items-center justify-between">
                <div>
                  <p class="font-medium">New Booking Alerts</p>
                  <p class="text-sm text-slate-600">Get notified when new bookings arrive</p>
                </div>
                <label class="relative inline-flex items-center cursor-pointer">
                  <input type="checkbox" checked class="sr-only peer">
                  <div class="w-11 h-6 bg-slate-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-teal-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-slate-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-teal-600"></div>
                </label>
              </div>
              <div class="flex items-center justify-between">
                <div>
                  <p class="font-medium">Ticket Updates</p>
                  <p class="text-sm text-slate-600">Notifications for ticket status changes</p>
                </div>
                <label class="relative inline-flex items-center cursor-pointer">
                  <input type="checkbox" checked class="sr-only peer">
                  <div class="w-11 h-6 bg-slate-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-teal-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-slate-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-teal-600"></div>
                </label>
              </div>
            </div>
          </div>

          <div class="bg-white rounded-2xl p-6 border border-slate-200">
            <h3 class="font-bold text-lg mb-4">Business Settings</h3>
            <div class="space-y-4">
              <div>
                <label class="block text-sm font-medium text-slate-700 mb-2">Business Name</label>
                <input type="text" value="Swachify Cleaning Services" class="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-teal-500 focus:outline-none">
              </div>
              <div>
                <label class="block text-sm font-medium text-slate-700 mb-2">Support Email</label>
                <input type="email" value="support@swachify.com" class="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-teal-500 focus:outline-none">
              </div>
            </div>
          </div>
        </div>
      </section>

    </main>
  </div>
  
  <!-- Employee Assignment Modal -->
  <div id="employeeModal" class="hidden fixed inset-0 bg-black/50 modal flex items-center justify-center p-4 z-50">
    <div class="bg-white rounded-2xl max-w-2xl w-full p-6 max-h-[80vh] overflow-y-auto fade-in">
      <div class="flex items-center justify-between mb-4">
        <h3 class="text-xl font-bold">Assign Employee</h3>
        <button onclick="closeEmployeeModal()" class="text-slate-400 hover:text-slate-600">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
          </svg>
        </button>
      </div>

      <input type="hidden" id="selectedBookingId">
      
      <div class="mb-4 p-4 bg-slate-50 rounded-xl">
        <p class="text-sm text-slate-600">Booking Details:</p>
        <p id="bookingDetailsDisplay" class="font-semibold text-slate-800"></p>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-4" id="employeeSelectionList">
        <!-- Employee cards will be inserted here -->
      </div>
    </div>
  </div>

  <!-- OTP Verification Modal -->
  <div id="otpModal" class="hidden fixed inset-0 bg-black/50 modal flex items-center justify-center p-4 z-50">
    <div class="bg-white rounded-2xl max-w-sm w-full p-6 fade-in shadow-lg">
      <div class="flex items-center justify-between mb-4">
        <h3 id="otpModalTitle" class="text-xl font-bold">Verify OTP</h3>
        <button onclick="closeOtpModal()" class="text-slate-400 hover:text-slate-600">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
          </svg>
        </button>
      </div>

      <form id="otpForm" onsubmit="verifyOTP(event)">
        <input type="hidden" id="otpTicketId">
        <input type="hidden" id="otpType">
        
        <p class="text-sm text-slate-600 mb-2">Enter the 4-digit OTP provided by the customer to proceed.</p>

        <input 
          type="tel" 
          id="otpInput"
          maxlength="4"
          required
          class="w-full text-center text-3xl tracking-[1em] font-bold py-3 border-2 border-slate-300 rounded-xl focus:border-teal-500 focus:outline-none transition-colors"
          placeholder="----"
        >
        <div id="otpError" class="text-red-500 text-sm mt-2 text-center h-4"></div>

        <button type="submit" class="w-full mt-4 bg-gradient-to-r from-teal-600 to-cyan-600 text-white py-3 rounded-lg font-semibold hover:shadow-md transition-all">
          Verify & Proceed
        </button>
      </form>
    </div>
  </div>


  <script>
    // --- Data Models ---
    const STORAGE_KEYS = {
      BOOKINGS: 'swachify_bookings',
      TICKETS: 'swachify_tickets',
      NOTIFICATIONS: 'swachify_notifications'
    };

    let bookings = JSON.parse(localStorage.getItem(STORAGE_KEYS.BOOKINGS) || '[]');
    let tickets = JSON.parse(localStorage.getItem(STORAGE_KEYS.TICKETS) || '[]');
    let notifications = JSON.parse(localStorage.getItem(STORAGE_KEYS.NOTIFICATIONS) || '[]');
    
    // Services Data for Search & Navigation
    const servicesData = [
        { category: 'Cleaning & Pest Control', subCategory: 'Bedroom Cleaning', image: 'images1/cleaning&pest control/bedroom-cleaning.jpg', parentViewId: 'sub-services-cleaning-view', targetViewId: 'pricing-bedroom' },
        { category: 'Cleaning & Pest Control', subCategory: 'Bathroom Cleaning', image: 'images1/cleaning&pest control/bathroom cleaning.jpeg', parentViewId: 'sub-services-cleaning-view', targetViewId: 'pricing-generic' },
        { category: 'Cleaning & Pest Control', subCategory: 'Kitchen Cleaning', image: 'images1/cleaning&pest control/kitchen cleaning.jpg', parentViewId: 'sub-services-cleaning-view', targetViewId: 'pricing-generic' },
        { category: 'Cleaning & Pest Control', subCategory: 'Living Area Cleaning', image: 'images1/cleaning&pest control/living area cleaning.jpg', parentViewId: 'sub-services-cleaning-view', targetViewId: 'pricing-generic' },
        { category: 'Cleaning & Pest Control', subCategory: 'Sofa & Carpet Cleaning', image: 'images1/cleaning&pest control/sofa cleaning.jpg', parentViewId: 'sub-services-cleaning-view', targetViewId: 'pricing-generic' },
        { category: 'Cleaning & Pest Control', subCategory: 'Pest Control', image: 'images1/cleaning&pest control/pest control.jpg', parentViewId: 'sub-services-cleaning-view', targetViewId: 'pricing-generic' },
        { category: 'Electrician, Plumber & Carpenter', subCategory: 'Switch & Sockets', image: 'images1/electrician/socket.jpg', parentViewId: 'sub-services-electrician-view', targetViewId: 'pricing-generic' },
        { category: 'Electrician, Plumber & Carpenter', subCategory: 'Fan Repair', image: 'images1/electrician/fan.jpg', parentViewId: 'sub-services-electrician-view', targetViewId: 'pricing-generic' },
        { category: 'Electrician, Plumber & Carpenter', subCategory: 'Wiring', image: 'images1/electrician/wiring.jpg', parentViewId: 'sub-services-electrician-view', targetViewId: 'pricing-generic' },
        { category: 'Electrician, Plumber & Carpenter', subCategory: 'Bath Fitting', image: 'images1/electrician/bath.jpg', parentViewId: 'sub-services-electrician-view', targetViewId: 'pricing-generic' },
        { category: 'Electrician, Plumber & Carpenter', subCategory: 'Sink & Basin Repair', image: 'images1/electrician/sink.jpg', parentViewId: 'sub-services-electrician-view', targetViewId: 'pricing-generic' },
        { category: 'Electrician, Plumber & Carpenter', subCategory: 'Carpenter', image: 'images1/electrician/carpenter.jpg', parentViewId: 'sub-services-electrician-view', targetViewId: 'pricing-generic' },
        { category: 'Painting & Waterproofing', subCategory: 'Full House Painting', image: 'images1/painting/house.jpeg', parentViewId: 'sub-services-painting-view', targetViewId: 'pricing-generic' },
        { category: 'Painting & Waterproofing', subCategory: 'Room Painting', image: 'images1/painting/room.png', parentViewId: 'sub-services-painting-view', targetViewId: 'pricing-generic' },
        { category: 'Painting & Waterproofing', subCategory: 'Exterior Painting', image: 'images1/painting/exterior.png', parentViewId: 'sub-services-painting-view', targetViewId: 'pricing-generic' },
        { category: 'Painting & Waterproofing', subCategory: 'Waterproofing', image: 'images1/painting/waterproof.webp', parentViewId: 'sub-services-painting-view', targetViewId: 'pricing-generic' },
        { category: 'AC & Appliances', subCategory: 'AC Service & Repair', image: 'images1/AC/ac repair.jpg', parentViewId: 'sub-services-ac-view', targetViewId: 'pricing-generic' },
        { category: 'AC & Appliances', subCategory: 'Refrigerator Repair', image: 'images1/AC/fridge.jpg', parentViewId: 'sub-services-ac-view', targetViewId: 'pricing-generic' },
        { category: 'AC & Appliances', subCategory: 'Washing Machine Repair', image: 'images1/AC/washin.jpeg', parentViewId: 'sub-services-ac-view', targetViewId: 'pricing-generic' },
        { category: 'AC & Appliances', subCategory: 'Microwave Repair', image: 'images1/AC/oven.jpg', parentViewId: 'sub-services-ac-view', targetViewId: 'pricing-generic' }
    ];

    const employees = [
      { id: 1, name: 'Arun Kumar', services: ['Home Cleaning', 'Kitchen', 'Bathroom'], status: 'Available', phone: '+91 98765 11111',location: 'Hyderabad'},
      { id: 2, name: 'Priya Sharma', services: ['Office Cleaning', 'Sofa & Carpet'], status: 'Available', phone: '+91 98765 22222',location: 'Bangalore' },
      { id: 3, name: 'Ravi Singh', services: ['Pest Control', 'Deep Cleaning'], status: 'Available', phone: '+91 98765 33333' ,location: 'Hyderabad'},
      { id: 4, name: 'Sunita Devi', services: ['Kitchen', 'Bathroom', 'Home Cleaning'], status: 'Available', phone: '+91 98765 44444',location: 'Delhi' },
      { id: 5, name: 'Anil Mehta', services: ['Painting', 'Home Cleaning'], status: 'Available', phone: '+91 98765 55555',location: 'Mumbai' },
      { id: 6, name: 'Geeta Gupta', services: ['AC Service', 'Appliance Repair'], status: 'Available', phone: '+91 98765 66666',location: 'Bangalore' },
      { id: 7, name: 'Sanjay Verma', services: ['Office Cleaning', 'Deep Cleaning'], status: 'Available', phone: '+91 98765 77777',location: 'Delhi' },
      { id: 8, name: 'Meena Kumari', services: ['Sofa & Carpet', 'Home Cleaning'], status: 'Available', phone: '+91 98765 88888' ,location: 'Mumbai'}
    ];

    // Initialize
    document.addEventListener('DOMContentLoaded', () => {
      setTimeout(() => {
        document.getElementById('splash').style.opacity = '0';
        setTimeout(() => document.getElementById('splash').style.display = 'none', 500);
      }, 1500);

      renderEmployees();
      updateDashboard();
      renderNotifications();
      
      const today = new Date().toISOString().split('T')[0];
      // Set min date for both date pickers
      const datePickers = document.querySelectorAll('input[type="date"]');
      datePickers.forEach(picker => picker.min = today);
    });

    function toggleMobileSearch() {
        const search = document.getElementById('mobileSearch');
        search.classList.toggle('hidden');
    }

    // --- NEW GLOBAL SEARCH LOGIC ---
    function closeGlobalSearch() {
        document.getElementById('globalSearchResults').classList.add('hidden');
        document.getElementById('searchInput').value = '';
        const mobileSearchInput = document.querySelector('#mobileSearch input');
        if (mobileSearchInput) {
            mobileSearchInput.value = '';
        }
    }

    function handleSearch(event) {
        const query = event.target.value.toLowerCase().trim();
        const resultsContainer = document.getElementById('searchResultsContainer');
        const searchDisplay = document.getElementById('searchQueryDisplay');
        const searchOverlay = document.getElementById('globalSearchResults');

        if (query.length < 2) {
            searchOverlay.classList.add('hidden');
            return;
        }

        searchOverlay.classList.remove('hidden');
        searchDisplay.textContent = query;

        const searchResults = {
            services: servicesData.filter(s => s.category.toLowerCase().includes(query) || s.subCategory.toLowerCase().includes(query)),
            bookings: bookings.filter(b => b.customerName.toLowerCase().includes(query) || b.service.toLowerCase().includes(query) || b.address.toLowerCase().includes(query)),
            tickets: tickets.filter(t => t.customerName.toLowerCase().includes(query) || t.service.toLowerCase().includes(query) || t.employee.toLowerCase().includes(query)),
            employees: employees.filter(e => e.name.toLowerCase().includes(query) || e.location.toLowerCase().includes(query) || e.services.some(s => s.toLowerCase().includes(query)))
        };

        renderSearchResults(searchResults);
    }

    function renderSearchResults(results) {
        const container = document.getElementById('searchResultsContainer');
        container.innerHTML = '';
        let totalResults = 0;

        // Render Services
        if (results.services.length > 0) {
            totalResults += results.services.length;
            let html = '<div class="result-category"><h3 class="font-bold text-lg mb-2 border-b pb-2">Services</h3><div class="space-y-2">';
            results.services.forEach(item => {
                html += `
                    <div class="p-3 rounded-lg hover:bg-slate-100 cursor-pointer flex items-center gap-4" onclick="navigateToServiceResult('${item.parentViewId}', '${item.targetViewId}', '${item.subCategory}')">
                        <img src="${item.image}" class="w-12 h-12 rounded-md object-cover">
                        <div>
                            <p class="font-semibold text-slate-700">${item.subCategory}</p>
                            <p class="text-sm text-slate-500">${item.category}</p>
                        </div>
                    </div>`;
            });
            container.innerHTML += html + '</div></div>';
        }
        
        // Render Bookings
        if (results.bookings.length > 0) {
            totalResults += results.bookings.length;
            let html = '<div class="result-category"><h3 class="font-bold text-lg mb-2 border-b pb-2">Bookings</h3><div class="space-y-2">';
            results.bookings.forEach(item => {
                html += `
                    <div class="p-3 rounded-lg hover:bg-slate-100 cursor-pointer" onclick="navigateToSection('bookings')">
                         <p class="font-semibold text-slate-700">${item.service}</p>
                         <p class="text-sm text-slate-500">For: ${item.customerName} on ${new Date(item.date).toLocaleDateString()}</p>
                    </div>`;
            });
            container.innerHTML += html + '</div></div>';
        }

        // Render Tickets
        if (results.tickets.length > 0) {
            totalResults += results.tickets.length;
            let html = '<div class="result-category"><h3 class="font-bold text-lg mb-2 border-b pb-2">Tickets</h3><div class="space-y-2">';
            results.tickets.forEach(item => {
                html += `
                    <div class="p-3 rounded-lg hover:bg-slate-100 cursor-pointer" onclick="navigateToSection('tickets')">
                         <p class="font-semibold text-slate-700">Ticket #${item.id.toString().slice(-6)} - ${item.service}</p>
                         <p class="text-sm text-slate-500">Assigned to: ${item.employee} for ${item.customerName}</p>
                    </div>`;
            });
            container.innerHTML += html + '</div></div>';
        }

        // Render Employees
        if (results.employees.length > 0) {
            totalResults += results.employees.length;
            let html = '<div class="result-category"><h3 class="font-bold text-lg mb-2 border-b pb-2">Employees</h3><div class="space-y-2">';
            results.employees.forEach(item => {
                html += `
                    <div class="p-3 rounded-lg hover:bg-slate-100 cursor-pointer flex items-center gap-4" onclick="navigateToSection('employees')">
                        <div class="w-12 h-12 rounded-full bg-gradient-to-br from-teal-500 to-cyan-500 flex items-center justify-center text-white font-bold">${item.name.charAt(0)}</div>
                        <div>
                            <p class="font-semibold text-slate-700">${item.name}</p>
                            <p class="text-sm text-slate-500">${item.location} - ${item.services.join(', ')}</p>
                        </div>
                    </div>`;
            });
            container.innerHTML += html + '</div></div>';
        }

        if (totalResults === 0) {
            container.innerHTML = '<p class="text-slate-500 text-center py-8">No results found.</p>';
        }
    }

    function navigateToServiceResult(parentViewId, targetViewId, subCategory) {
        showSection('services');
        navigateTo(parentViewId);
        setTimeout(() => navigateTo(targetViewId, subCategory), 100);
        closeGlobalSearch();
    }

    function navigateToSection(sectionId) {
        showSection(sectionId);
        closeGlobalSearch();
    }
    // --- END GLOBAL SEARCH LOGIC ---


    // Mobile Menu
    document.getElementById('menuToggle').addEventListener('click', toggleSidebar);

    function toggleSidebar() {
      const sidebar = document.getElementById('sidebar');
      const overlay = document.getElementById('sidebarOverlay');
      
      sidebar.classList.toggle('-translate-x-full');
      overlay.classList.toggle('hidden');
    }

    // Navigation
    function showSection(section) {
      document.querySelectorAll('.content-section').forEach(s => {
          s.classList.add('hidden');
          s.classList.remove('active-section');
      });
      const activeSection = document.getElementById(section);
      activeSection.classList.remove('hidden');
      activeSection.classList.add('active-section');
      
      document.querySelectorAll('.sidebar-btn').forEach(btn => {
        btn.classList.remove('sidebar-active', 'text-white');
        btn.classList.add('text-slate-600');
        if (btn.dataset.section === section) {
          btn.classList.add('sidebar-active', 'text-white');
          btn.classList.remove('text-slate-600');
        }
      });

      if (window.innerWidth < 1024) toggleSidebar();
      if (section === 'bookings') renderBookings();
      if (section === 'tickets') renderTickets();
      if (section === 'employees') renderEmployees();
    }
    
    // --- NEW SERVICE SECTION LOGIC ---
    let navigationStack = ['main-view'];
    let lastServiceGroup = '';
    let lastSubService = '';
    
    const bookingForm = document.getElementById('booking-form');

    function navigateTo(viewId, data = null) {
        const allServiceViews = document.querySelectorAll('#services .view');

        if (viewId.startsWith('sub-services-') && data) {
            lastServiceGroup = data;
        } else if (viewId.startsWith('pricing-') && data) {
            lastSubService = data;
            if (viewId === 'pricing-generic') {
                const genericHeader = document.querySelector('#pricing-generic-view header h1');
                if (genericHeader) genericHeader.textContent = data + ' Plans';
            }
        } else if (viewId === 'booking-form' && data) {
            document.getElementById('selected-service-group').value = lastServiceGroup;
            document.getElementById('selected-sub-service').value = lastSubService;
            document.getElementById('selected-service-plan').value = data;
        }

        if (viewId === 'main') {
            navigationStack = ['main-view'];
            viewId = 'main-view';
        }

        const targetViewId = viewId.endsWith('-view') ? viewId : viewId + '-view';
        const targetView = document.getElementById(targetViewId);
        
        if (!targetView) {
            console.error("View not found:", targetViewId);
            return;
        }

        allServiceViews.forEach(view => view.classList.remove('active'));
        targetView.classList.add('active');

        if (navigationStack[navigationStack.length - 1] !== targetViewId) {
            navigationStack.push(targetViewId);
        }
    }

    function goBack() {
        if (navigationStack.length > 1) {
            navigationStack.pop();
            const previousViewId = navigationStack[navigationStack.length - 1];
            const previousView = document.getElementById(previousViewId);
            if (previousView) {
                document.querySelectorAll('#services .view').forEach(view => view.classList.remove('active'));
                previousView.classList.add('active');
            }
        }
    }

    document.querySelectorAll('.time-slot-btn').forEach(button => {
        button.addEventListener('click', () => {
            document.querySelectorAll('.time-slot-btn').forEach(btn => {
                btn.classList.remove('bg-teal-600', 'text-white');
                btn.classList.add('bg-slate-100', 'text-slate-700');
            });
            button.classList.add('bg-teal-600', 'text-white');
            button.classList.remove('bg-slate-100', 'text-slate-700');
            document.getElementById('time').value = button.dataset.time;
        });
    });

    bookingForm.addEventListener('submit', function(event) {
        event.preventDefault();
        const serviceGroup = document.getElementById('selected-service-group').value;
        const subService = document.getElementById('selected-sub-service').value;
        const servicePlan = document.getElementById('selected-service-plan').value;
        
        const booking = {
            id: Date.now(),
            service: `${serviceGroup} - ${subService} (${servicePlan})`,
            price: 'Varies',
            customerName: document.getElementById('name').value,
            phone: document.getElementById('phone').value,
            address: document.getElementById('address').value,
            date: document.getElementById('date').value,
            time: document.getElementById('time').value,
            status: 'Pending',
            createdAt: new Date().toISOString()
        };

        bookings.push(booking);
        localStorage.setItem(STORAGE_KEYS.BOOKINGS, JSON.stringify(bookings));
        addNotification(`New booking: ${booking.service} for ${booking.customerName}`);
        
        navigateTo('acknowledgement');
        bookingForm.reset();
        document.querySelectorAll('.time-slot-btn').forEach(btn => {
            btn.classList.remove('bg-teal-600', 'text-white');
            btn.classList.add('bg-slate-100', 'text-slate-700');
        });
        updateDashboard();
    });


    // Render Bookings
    function renderBookings() {
      const container = document.getElementById('bookingsList');
      const pendingBookings = bookings.filter(b => b.status === 'Pending');

      if (pendingBookings.length === 0) {
        container.innerHTML = `<div class="text-center py-12 text-slate-400"><svg class="w-16 h-16 mx-auto mb-3 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/></svg><p>No pending bookings</p></div>`;
        return;
      }

      container.innerHTML = pendingBookings.map(booking => `
        <div class="bg-white rounded-xl p-6 border-2 border-slate-200 hover:border-teal-300 transition-all">
          <div class="flex flex-col md:flex-row md:items-center justify-between gap-4">
            <div class="flex-1">
              <h3 class="font-bold text-lg mb-2">${booking.service}</h3>
              <div class="space-y-1 text-sm text-slate-600">
                <p>ðŸ‘¤ ${booking.customerName}</p><p>ðŸ“ž ${booking.phone}</p><p>ðŸ“ ${booking.address}</p>
                <p>ðŸ“… ${new Date(booking.date).toLocaleDateString()} at ${booking.time}</p>
                ${booking.price !== 'Varies' ? `<p class="text-teal-600 font-semibold">${booking.price}</p>` : ''}
              </div>
            </div>
            <div class="flex flex-col gap-2">
              <span class="px-3 py-1 rounded-full text-xs font-semibold bg-amber-100 text-amber-600 text-center">${booking.status}</span>
              <button onclick="openEmployeeModal(${booking.id})" class="px-4 py-2 bg-teal-600 text-white rounded-lg font-semibold hover:bg-teal-700 transition-all">Assign Employee</button>
            </div>
          </div>
        </div>`).join('');
    }
    
    function generateOTP() {
      return Math.floor(1000 + Math.random() * 9000).toString();
    }

    function promptForOTP(ticketId, type) {
      document.getElementById('otpTicketId').value = ticketId;
      document.getElementById('otpType').value = type;
      document.getElementById('otpModalTitle').textContent = `Verify ${type === 'start' ? 'Start' : 'Completion'} OTP`;
      document.getElementById('otpModal').classList.remove('hidden');
      document.getElementById('otpInput').focus();
    }
    
    function closeOtpModal() {
        document.getElementById('otpModal').classList.add('hidden');
        document.getElementById('otpForm').reset();
        document.getElementById('otpError').textContent = '';
    }
    
    function verifyOTP(event) {
      event.preventDefault();
      const ticketId = parseInt(document.getElementById('otpTicketId').value);
      const type = document.getElementById('otpType').value;
      const enteredOtp = document.getElementById('otpInput').value;
      const errorDiv = document.getElementById('otpError');
      
      const ticket = tickets.find(t => t.id === ticketId);
      let correctOtp;

      if (type === 'start') {
        correctOtp = ticket.startOTP;
      } else {
        correctOtp = ticket.endOTP;
      }

      if (enteredOtp === correctOtp) {
        errorDiv.textContent = '';
        if (type === 'start') {
          ticket.status = 'In Progress';
          ticket.endOTP = generateOTP();
          addNotification(`Service started for ticket #${ticket.id}`);
        } else {
          ticket.status = 'Completed';
          ticket.completedAt = new Date().toISOString();
          const employee = employees.find(e => e.id === ticket.employeeId);
          if (employee) employee.status = 'Available';
          addNotification(`Service completed for ticket #${ticket.id}`);
        }
        
        localStorage.setItem(STORAGE_KEYS.TICKETS, JSON.stringify(tickets));
        closeOtpModal();
        renderTickets();
        renderEmployees();
        updateDashboard();

      } else {
        errorDiv.textContent = 'Invalid OTP. Please try again.';
      }
    }

    function openEmployeeModal(bookingId) {
      const booking = bookings.find(b => b.id === bookingId);
      document.getElementById('selectedBookingId').value = bookingId;
      document.getElementById('bookingDetailsDisplay').textContent = `${booking.service} - ${booking.customerName}`;

      const availableEmployees = employees.filter(e => e.status === 'Available');
      const container = document.getElementById('employeeSelectionList');

      container.innerHTML = availableEmployees.map(emp => `
        <div onclick="assignEmployeeToBooking(${emp.id})" class="p-4 border-2 border-slate-200 rounded-xl hover:border-teal-500 hover:bg-teal-50 cursor-pointer transition-all">
          <div class="flex items-center gap-3">
            <div class="w-12 h-12 rounded-full bg-gradient-to-br from-teal-500 to-cyan-500 flex items-center justify-center text-white font-bold">${emp.name.charAt(0)}</div>
            <div>
              <p class="font-bold">${emp.name}</p>
              <p class="text-xs text-slate-600">${emp.services.join(', ')}</p>
              <p class="text-xs text-green-600 mt-1">â— ${emp.status}</p>
            </div>
          </div>
        </div>`).join('');

      document.getElementById('employeeModal').classList.remove('hidden');
    }

    function closeEmployeeModal() {
      document.getElementById('employeeModal').classList.add('hidden');
    }

    function assignEmployeeToBooking(employeeId) {
      const bookingId = parseInt(document.getElementById('selectedBookingId').value);
      const booking = bookings.find(b => b.id === bookingId);
      const employee = employees.find(e => e.id === employeeId);

      booking.status = 'Assigned';
      booking.assignedTo = employee.name;
      booking.employeeId = employeeId;

      const ticket = {
        id: Date.now(),
        bookingId: bookingId,
        service: booking.service,
        customerName: booking.customerName,
        address: booking.address,
        date: booking.date,
        time: booking.time,
        employee: employee.name,
        employeeId: employeeId,
        status: 'Open',
        createdAt: new Date().toISOString(),
        startOTP: generateOTP(),
        endOTP: null
      };

      tickets.push(ticket);
      employee.status = 'Assigned';

      localStorage.setItem(STORAGE_KEYS.BOOKINGS, JSON.stringify(bookings));
      localStorage.setItem(STORAGE_KEYS.TICKETS, JSON.stringify(tickets));

      addNotification(`Ticket assigned to ${employee.name} for ${booking.service}`);
      closeEmployeeModal();
      renderBookings();
      renderEmployees();
      updateDashboard();
      showSection('tickets');
    }

    function renderTickets(filter = 'all') {
      const container = document.getElementById('ticketsList');
      let filteredTickets = tickets;

      if (filter !== 'all') {
        if (filter === 'in-progress') {
           filteredTickets = tickets.filter(t => t.status === 'In Progress');
        } else {
           filteredTickets = tickets.filter(t => t.status.toLowerCase() === filter);
        }
      }

      if (filteredTickets.length === 0) {
        container.innerHTML = `<div class="text-center py-12 text-slate-400"><svg class="w-16 h-16 mx-auto mb-3 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"/></svg><p>No tickets found</p></div>`;
        return;
      }

      container.innerHTML = filteredTickets.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt)).map(ticket => {
        let statusColor, borderColor, actionButton;

        switch (ticket.status) {
          case 'Open':
            statusColor = 'bg-amber-100 text-amber-600';
            borderColor = 'border-amber-200';
            actionButton = `<button onclick="promptForOTP(${ticket.id}, 'start')" class="px-4 py-2 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition-all">Start Service</button>`;
            break;
          case 'In Progress':
            statusColor = 'bg-blue-100 text-blue-600';
            borderColor = 'border-blue-200';
            actionButton = `<button onclick="promptForOTP(${ticket.id}, 'end')" class="px-4 py-2 bg-emerald-600 text-white rounded-lg font-semibold hover:bg-emerald-700 transition-all">Complete Service</button>`;
            break;
          case 'Completed':
            statusColor = 'bg-emerald-100 text-emerald-600';
            borderColor = 'border-emerald-200';
            actionButton = `<div class="text-emerald-600 font-semibold text-center md:text-right">âœ“ Completed</div>`;
            break;
        }

        const otpForDemo = ticket.status === 'Open' ? ticket.startOTP : (ticket.endOTP || 'N/A');

        return `
        <div class="bg-white rounded-xl p-6 border-2 ${borderColor}">
          <div class="flex flex-col md:flex-row md:items-start justify-between gap-4">
            <div class="flex-1">
              <div class="flex items-center gap-3 mb-3">
                <span class="px-3 py-1 rounded-full text-xs font-semibold ${statusColor}">${ticket.status}</span>
                <span class="text-xs text-slate-500">Ticket #${ticket.id.toString().slice(-6)}</span>
              </div>
              <h3 class="font-bold text-lg mb-2">${ticket.service}</h3>
              <div class="space-y-1 text-sm text-slate-600">
                <p>ðŸ‘¤ ${ticket.customerName}</p>
                <p>ðŸ‘· Assigned to: <span class="font-semibold text-teal-600">${ticket.employee}</span></p>
                <p>ðŸ“ ${ticket.address}</p>
                <p>ðŸ“… ${new Date(ticket.date).toLocaleDateString()} at ${ticket.time}</p>
              </div>
            </div>
            <div class="flex flex-col items-stretch gap-3">
              ${actionButton}
              <div class="mt-2 p-2 bg-slate-100 rounded-lg text-center">
                <p class="text-xs text-slate-500">For Demo: Customer's OTP</p>
                <p class="font-bold text-xl text-red-500 tracking-widest">${otpForDemo}</p>
              </div>
            </div>
          </div>
        </div>`
      }).join('');
    }

    function filterTickets(filter) {
      document.querySelectorAll('.ticket-filter-btn').forEach(btn => {
        btn.classList.remove('bg-teal-600', 'text-white');
        btn.classList.add('bg-slate-200', 'text-slate-700');
      });
      event.target.classList.add('bg-teal-600', 'text-white');
      event.target.classList.remove('bg-slate-200', 'text-slate-700');
      
      renderTickets(filter);
    }
    
    // --- NEW EMPLOYEE SECTION LOGIC ---
    function renderEmployees() {
        const listContainer = document.getElementById('employeeListContainer');
        const selectedLocation = document.getElementById('locationFilter')?.value || 'all';

        const filteredEmployees = selectedLocation === 'all'
            ? employees
            : employees.filter(emp => emp.location === selectedLocation);

        if (filteredEmployees.length === 0) {
            listContainer.innerHTML = '<p class="text-center text-slate-400 p-4">No employees in this location</p>';
            return;
        }

        listContainer.innerHTML = `
            <div class="space-y-2">
                ${filteredEmployees.map(emp => `
                    <div id="emp-name-${emp.id}" onclick="displayEmployeeDetails(${emp.id})" class="p-3 rounded-lg cursor-pointer hover:bg-teal-50 flex justify-between items-center transition-colors">
                        <span class="font-semibold text-slate-700">${emp.name}</span>
                        <svg class="w-4 h-4 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
                    </div>
                `).join('')}
            </div>
        `;
    }

    function displayEmployeeDetails(employeeId) {
        // Highlight active name
        document.querySelectorAll('#employeeListContainer > div > div').forEach(el => el.classList.remove('bg-teal-100', 'text-teal-800'));
        document.getElementById(`emp-name-${employeeId}`).classList.add('bg-teal-100', 'text-teal-800');

        const detailsContainer = document.getElementById('employeeDetailsContainer');
        const emp = employees.find(e => e.id === employeeId);

        if (!emp) return;

        detailsContainer.innerHTML = `
            <div class="flex flex-col items-center text-center">
                <div class="w-24 h-24 rounded-full bg-gradient-to-br from-teal-500 to-cyan-500 flex items-center justify-center text-white text-4xl font-bold mb-4">
                    ${emp.name.charAt(0)}
                </div>
                <h3 class="font-bold text-2xl">${emp.name}</h3>
                <p class="text-sm px-3 py-1 rounded-full mt-2 ${emp.status === 'Available' ? 'bg-emerald-100 text-emerald-600' : 'bg-amber-100 text-amber-600'}">â— ${emp.status}</p>

                <div class="text-left w-full mt-6 space-y-4">
                    <div>
                        <p class="text-xs text-slate-500 mb-1 font-semibold uppercase tracking-wider">Contact</p>
                        <p class="text-slate-700">ðŸ“ž ${emp.phone}</p>
                        <p class="text-slate-700">ðŸ“ ${emp.location}</p>
                    </div>
                    <div>
                        <p class="text-xs text-slate-500 mb-2 font-semibold uppercase tracking-wider">Specialties</p>
                        <div class="flex flex-wrap gap-2">
                        ${emp.services.map(s => `<span class="text-sm px-3 py-1 bg-slate-100 text-slate-600 rounded-full">${s}</span>`).join('')}
                        </div>
                    </div>
                </div>
            </div>
        `;
    }
    // --- END NEW EMPLOYEE SECTION LOGIC ---

    // Notifications
    function addNotification(message) {
      const notification = { id: Date.now(), message, read: false, timestamp: new Date().toISOString() };
      notifications.unshift(notification);
      localStorage.setItem(STORAGE_KEYS.NOTIFICATIONS, JSON.stringify(notifications));
      renderNotifications();
      updateDashboard();
    }

    function renderNotifications() {
      const container = document.getElementById('notificationList');
      const badge = document.getElementById('notifBadge');
      const unreadCount = notifications.filter(n => !n.read).length;
      badge.textContent = unreadCount;
      badge.classList.toggle('hidden', unreadCount === 0);

      if (notifications.length === 0) {
        container.innerHTML = '<p class="p-4 text-center text-slate-400">No notifications</p>';
        return;
      }

      container.innerHTML = notifications.slice(0, 10).map(notif => `
        <div class="p-4 hover:bg-slate-50 ${!notif.read ? 'bg-teal-50' : ''}">
          <p class="text-sm ${!notif.read ? 'font-semibold' : ''}">${notif.message}</p>
          <p class="text-xs text-slate-500 mt-1">${new Date(notif.timestamp).toLocaleString()}</p>
        </div>`).join('');
    }

    function toggleNotifications() {
      const panel = document.getElementById('notificationPanel');
      panel.classList.toggle('hidden');
      if (!panel.classList.contains('hidden')) {
        notifications.forEach(n => n.read = true);
        localStorage.setItem(STORAGE_KEYS.NOTIFICATIONS, JSON.stringify(notifications));
        renderNotifications();
      }
    }

    function clearAllNotifications() {
      notifications = [];
      localStorage.setItem(STORAGE_KEYS.NOTIFICATIONS, JSON.stringify(notifications));
      renderNotifications();
    }

    // Update Dashboard
    function updateDashboard() {
      document.getElementById('totalServices').textContent = bookings.length;
      document.getElementById('activeBookings').textContent = bookings.filter(b => b.status === 'Pending').length;
      document.getElementById('openTickets').textContent = tickets.filter(t => t.status === 'Open' || t.status === 'In Progress').length;
      document.getElementById('bookingBadge').textContent = bookings.filter(b => b.status === 'Pending').length;
      document.getElementById('ticketBadge').textContent = tickets.filter(t => t.status === 'Open' || t.status === 'In Progress').length;
      
      const recentBookings = bookings.slice(-5).reverse();
      const recentContainer = document.getElementById('recentBookingsList');
      recentContainer.innerHTML = recentBookings.length ? recentBookings.map(b => `<div class="p-3 border-2 border-slate-200 rounded-lg"><p class="font-semibold">${b.service}</p><p class="text-sm text-slate-600">${b.customerName}</p><span class="text-xs px-2 py-1 rounded-full ${b.status === 'Pending' ? 'bg-amber-100 text-amber-600' : 'bg-teal-100 text-teal-600'}">${b.status}</span></div>`).join('') : '<div class="text-center py-8 text-slate-400"><svg class="w-12 h-12 mx-auto mb-2 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"/></svg><p>No recent bookings</p></div>';

      const activeTickets = tickets.filter(t => t.status !== 'Completed').slice(-5).reverse();
      const ticketsContainer = document.getElementById('activeTicketsList');
      ticketsContainer.innerHTML = activeTickets.length ? activeTickets.map(t => `<div class="p-3 border-2 border-amber-200 rounded-lg"><p class="font-semibold">${t.service}</p><p class="text-sm text-slate-600">ðŸ‘· ${t.employee}</p><span class="text-xs px-2 py-1 rounded-full bg-amber-100 text-amber-600">${t.status}</span></div>`).join('') : '<div class="text-center py-8 text-slate-400"><svg class="w-12 h-12 mx-auto mb-2 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"/></svg><p>No active tickets</p></div>';
    }

    // Logout
    function logout() {
      if (confirm('Are you sure you want to logout?')) {
        localStorage.removeItem('swachify_current_user'); 
        window.location.href = 'index.html';
      }
    }

    // Close dropdowns
    document.addEventListener('click', (e) => {
      if (!e.target.closest('button[onclick="toggleNotifications()"]') && !e.target.closest('#notificationPanel')) {
        document.getElementById('notificationPanel').classList.add('hidden');
      }
    });
  </script>
</body>
</html>

